target C {
    scheduler: STATIC,
    timeout: 3 sec,
    build-type: Debug,
}

/**
 * TODO
 * 1. source_reactor of output port not set. Was it set for the dynamic runtime?
 * 2. sink.c missing in->token, in->value assignment.
 */

reactor Source {
    output out:int
    timer t(0, 1 sec)
    state s:int = 0
    reaction(t) -> out {=
        lf_set(out, self->s);
        lf_print("Sent %d @ %lld", self->s++, lf_time_logical_elapsed());
    =}
}

reactor Sink {
    input in:int
    reaction(in) {=
        lf_print("Received %d @ %lld", in->value, lf_time_logical_elapsed());
    =}
}

main reactor {
    source = new Source()
    sink = new Sink()
    source.out -> sink.in after 2 sec
    // source.out -> sink.in after 500 msec
}